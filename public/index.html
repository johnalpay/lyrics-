<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lyrics Finder with Search Suggestions</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #fff;
      max-width: 600px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    header {
      display: flex;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .logo {
      font-size: 2rem;
      margin-right: 0.6rem;
      color: #1db954;
    }
    h1 {
      font-size: 1.8rem;
      font-weight: bold;
    }
    input, button {
      width: 100%;
      padding: 0.7rem;
      margin-top: 0.7rem;
      border-radius: 6px;
      border: none;
      font-size: 1rem;
    }
    input {
      background-color: #1e1e1e;
      color: #fff;
    }
    button {
      background-color: #1db954;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background-color: #1ed760;
    }
    pre {
      white-space: pre-wrap;
      background: #1e1e1e;
      padding: 1rem;
      border-radius: 8px;
      margin-top: 1.5rem;
      font-size: 1rem;
    }
    /* Floating Facebook button */
    .fb-float {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #1877f2;
      color: white;
      border-radius: 50%;
      width: 55px;
      height: 55px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      transition: background-color 0.3s ease, transform 0.3s ease;
      z-index: 1000;
    }
    .fb-float:hover {
      background-color: #0e63d1;
      transform: scale(1.1);
    }
    .fb-float i {
      font-size: 1.6rem;
    }
    /* Suggestions box */
    .suggestions {
      position: relative;
    }
    ul.suggestions-list {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: 150px;
      overflow-y: auto;
      background: #1e1e1e;
      border-radius: 6px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.6);
      position: absolute;
      width: 100%;
      z-index: 999;
    }
    ul.suggestions-list li {
      padding: 0.5rem;
      cursor: pointer;
      border-bottom: 1px solid #333;
    }
    ul.suggestions-list li:last-child {
      border-bottom: none;
    }
    ul.suggestions-list li:hover {
      background: #333;
    }
    @media (max-width: 600px) {
      body {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <i class="bi bi-music-note-beamed logo"></i>
    <h1>Lyrics Finder</h1>
  </header>

  <form onsubmit="findLyrics(event)" autocomplete="off">
    <div class="suggestions">
      <input type="text" id="artist" placeholder="Artist (e.g. Ed Sheeran)" required oninput="debouncedSuggestArtist()" />
      <ul id="artist-suggestions" class="suggestions-list" style="display:none;"></ul>
    </div>
    <div class="suggestions">
      <input type="text" id="title" placeholder="Song Title (e.g. Perfect)" required oninput="debouncedSuggestTitle()" />
      <ul id="title-suggestions" class="suggestions-list" style="display:none;"></ul>
    </div>
    <button type="submit">Get Lyrics</button>
  </form>

  <pre id="result">Enter artist and title above ⬆️</pre>

  <!-- Floating Facebook Follow Button -->
  <a href="https://www.facebook.com/profile.php?id=61576992292379" target="_blank" class="fb-float" title="Follow me on Facebook">
    <i class="bi bi-facebook"></i>
  </a>

  <script>
    // Debounce helper
    function debounce(func, delay) {
      let timer;
      return function(...args) {
        clearTimeout(timer);
        timer = setTimeout(() => func.apply(this, args), delay);
      };
    }

    // Suggest Artist (basic, fake suggestion by fetching lyrics for popular songs)
    async function suggestArtist() {
      const artistInput = document.getElementById('artist');
      const val = artistInput.value.trim();
      const list = document.getElementById('artist-suggestions');

      if (val.length < 2) {
        list.style.display = 'none';
        return;
      }

      // For demo: we'll simulate suggestions by calling the API with partial title guesses
      // Since lyrics.ovh doesn't provide search, we fake suggestion by pre-defined list filtered by input
      const popularArtists = [
        'Ed Sheeran',
        'Adele',
        'Taylor Swift',
        'Bruno Mars',
        'Billie Eilish',
        'The Weeknd',
        'Dua Lipa',
        'Coldplay',
        'Maroon 5',
        'Imagine Dragons'
      ];
      const filtered = popularArtists.filter(a => a.toLowerCase().includes(val.toLowerCase()));
      if (filtered.length) {
        list.innerHTML = filtered.map(a => `<li onclick="selectSuggestion('artist', '${a.replace(/'/g,"\\'")}')">${a}</li>`).join('');
        list.style.display = 'block';
      } else {
        list.style.display = 'none';
      }
    }

    // Suggest Title (similar fake suggestion)
    async function suggestTitle() {
      const titleInput = document.getElementById('title');
      const val = titleInput.value.trim();
      const list = document.getElementById('title-suggestions');

      if (val.length < 2) {
        list.style.display = 'none';
        return;
      }

      // Popular songs list (for demo only)
      const popularSongs = [
        'Perfect',
        'Shape of You',
        'Hello',
        'Someone Like You',
        'Blinding Lights',
        'Levitating',
        'Bad Guy',
        'Counting Stars',
        'Thunder',
        'Memories'
      ];

      const filtered = popularSongs.filter(t => t.toLowerCase().includes(val.toLowerCase()));
      if (filtered.length) {
        list.innerHTML = filtered.map(t => `<li onclick="selectSuggestion('title', '${t.replace(/'/g,"\\'")}')">${t}</li>`).join('');
        list.style.display = 'block';
      } else {
        list.style.display = 'none';
      }
    }

    const debouncedSuggestArtist = debounce(suggestArtist, 300);
    const debouncedSuggestTitle = debounce(suggestTitle, 300);

    function selectSuggestion(type, value) {
      document.getElementById(type).value = value;
      if(type === 'artist'){
        document.getElementById('artist-suggestions').style.display = 'none';
      } else {
        document.getElementById('title-suggestions').style.display = 'none';
      }
    }

    async function findLyrics(event) {
      event.preventDefault();
      const artist = document.getElementById('artist').value.trim();
      const title = document.getElementById('title').value.trim();
      const result = document.getElementById('result');

      if(!artist || !title){
        result.innerText = '⚠️ Please fill both Artist and Title!';
        return;
      }

      result.innerText = '🎶 Searching lyrics...';

      try {
        const res = await fetch(`/api/lyrics?artist=${encodeURIComponent(artist)}&title=${encodeURIComponent(title)}`);
        const data = await res.json();

        if(data.lyrics){
          result.innerText = `${data.artist} - ${data.title}\n\n${data.lyrics}`;
        } else if(data.error){
          result.innerText = `❌ ${data.error}`;
        } else {
          result.innerText = 'Lyrics not found.';
        }
      } catch (err) {
        result.innerText = '⚠️ Error fetching lyrics.';
      }
    }
  </script>
</body>
</html>
